# スクリプト リファレンス: exploit.py (v4)

## 1. 目的

このスクリプトは、「レート制限の欠如」（CWE-770）の脆弱性を実証するために作成された概念実証（PoC）ツールです。アカウント作成、商品出品、コメント投稿といったWebアプリケーションの特定の機能に対し、短時間で大量のリクエストを送信することができます。

**免責事項:** このツールは教育および許可されたテスト目的でのみ使用してください。テストする許可を得ていないシステムに対しては使用しないでください。

## 2. ファイルの場所

`exploit/exploit.py`

## 3. 要件

- Python 3
- `requests` ライブラリ (通常はPythonに同梱されていますが、`pip install requests`でインストール可能です)

## 4. 利用方法

```bash
python exploit.py <モード> [オプション]
```

**注:** ターゲットURLは `-t` または `--target` オプションで指定できます。指定されなかった場合、スクリプト実行時にプロンプトで入力を求められます。

---

## 5. モード

スクリプトは以下の3つのモードのいずれかで動作します。

### `register`
- **説明:** 複数の新規ユーザーアカウントを作成します。
- **認証:** 不要です。
- **コマンド例:**
  ```bash
  # ターゲットURLは実行後に問われます
  python exploit.py register -n 100
  ```

### `product`
- **説明:** 複数の新しい商品を連続で出品します。
- **認証:** **必須です。** スクリプト実行時に `PHPSESSID` クッキーの値の入力を求められます。
- **コマンド例:**
  ```bash
  # ターゲットURLとセッションIDは実行後に問われます
  python exploit.py product -n 50
  ```

### `comment`
- **説明:** 特定の商品に対して複数のコメントを連続で投稿します。
- **認証:** **必須です。** スクリプト実行時に `PHPSESSID` クッキーの値の入力を求められます。
- **特徴:** 攻撃前に商品ページから`csrf_token`を自動で取得します。
- **コマンド例:**
  ```bash
  # 商品ID 5番に200件のコメントを投稿する
  # ターゲットURLとセッションIDは実行後に問われます
  python exploit.py comment -n 200 --id 5
  ```

---

## 6. 引数とオプション

### 位置引数

- `mode`
  - **説明:** 攻撃の動作モード。
  - **指定可能な値:** `register`, `product`, `comment`

### オプション引数

- `-t, --target <URL>`
  - **説明:** ターゲットとなるWebアプリケーションのURL。このオプションを省略した場合、スクリプト実行時に入力を求められます。
  - **例:** `http://192.168.178.128`

- `-n, --number <整数>`
  - **説明:** 送信するリクエストの総数。
  - **デフォルト値:** `10`

- `--id <整数>`
  - **説明:** コメントを投稿する対象の商品ID。このオプションは `comment` モードでのみ使用されます。
  - **デフォルト値:** `1`

- `-h, --help`
  - **説明:** ヘルプメッセージを表示して終了します。

---

## 7. 認証が必要なモードの実行手順 (`product`, `comment`)

ログインが必要なモードを使用するには、以下の手順に従ってください。スクリプトを実行すると、まずターゲットURL（コマンドラインで指定されなかった場合）、次いでセッションIDの入力が求められます。

1.  **ログイン:** まず、お使いのWebブラウザで通常通りにアプリケーションにログインします。
2.  **開発者ツールを開く:** ブラウザで `F12` キー（または `Ctrl+Shift+I` / `Cmd+Opt+I`）を押して、開発者ツールを開きます。
3.  **Cookieを探す:** `アプリケーション` タブ（Chrome/Edgeの場合）または `ストレージ` タブ（Firefoxの場合）に移動します。
4.  **セッションIDをコピー:** 左側のメニューから `Cookie` を選択し、サイトのURLをクリックします。`PHPSESSID` という名前のCookieを見つけ、その `値 (Value)` をコピーします。
5.  **スクリプトを実行:** `product` または `comment` モードで `exploit.py` を実行します。
6.  **IDを貼り付け:** スクリプトに `[?] Please enter your ...` と表示されたら、指示に従ってコピーした値を貼り付けてEnterキーを押します。

これにより、スクリプトはログイン状態を引き継いで認証済みリクエストを実行します。
